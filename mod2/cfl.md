__Context-free Languages__

_ict chapter 17_


‚òØ Theorem 1 
---
üÖ∞ CFLs are closed under `union, product, and Kleene closure`. 
- i.e. given two CFLs: L‚ÇÅ and L‚ÇÇ, 
- `‚ù∂ L‚ÇÅ + L‚ÇÇ, ‚ù∑L‚ÇÅL‚ÇÇ, and ‚ù∏L‚ÇÅ*` are all `context-free`.

‚ö†Ô∏è üÖ± `NOT true` for the `complement` and `intersection` of CFLs since
- some are `non-context-free`
- some are `context-free`


Prove by construction üÖ∞:
- suppose L‚ÇÅ, L‚ÇÇ can be generated by CFG1 and CFG2 respectively
  - rename their nonterminals to avoid name conflict
  - add new nonterminal S and new production rules to the `combination of CFG1 and CFG2` 
- for `‚ù∂ L‚ÇÅ + L‚ÇÇ`, add
  - `S ‚Üí S‚ÇÅ | S‚ÇÇ` 
  - this is the CFG of L‚ÇÅ+L‚ÇÇ since
    - all words in L‚ÇÅ can be generated by S ‚Üí S‚ÇÅ and CFG1
    - all words in L‚ÇÇ can be generated by S ‚Üí S‚ÇÇ and CFG2
  - this can also be done with PDAs
    - ![f00](./img/f00.png)
  - üçé Example

| PDA‚ÇÅ |  | PDA‚ÇÇ |  | PDA‚ÇÉ |
|:--:|:--:|:--:|:--:|:--:|
| ![f01a](./img/f01a.png) | `+` | ![f01b](./img/f01b.png) | `=` | ![f01c](./img/f01c.png) |

- for `‚ù∑L‚ÇÅL‚ÇÇ`, add
  - `S ‚Üí S‚ÇÅS‚ÇÇ`
  - by PDAs
    - ![f02](./img/f02.png)

- üçé Example
    - try running `(baabbb)(aa)`

| PDA‚ÇÅ |  | PDA‚ÇÇ |  | PDA‚ÇÉ |
|:--:|:--:|:--:|:--:|:--:|
| ![f02a](./img/f02a.png) | `√ó` | ![f02b](./img/f02b.png) | `=` | ![f02c](./img/f02c.png) |

- üí° How many ways does the operator have to run `(baabbb)(aa)`?
  - All ways will crash PDA‚ÇÉ. Why? 
    - PDA‚ÇÇ works on `corrupted tape and nonempty stack` because we did NOT clean the tape and stack before leave from PDA‚ÇÅ
      - How about `(abbabaa)(abba)`?
    - This PDA‚ÇÉ accepts words contain `aaa` only
  - Corrected version
    - modify PDA‚ÇÅ to clean the tape and stack before leave
    - Do we need to clean PDA‚ÇÇ as well?

| PDA‚ÇÅ |  | PDA‚ÇÇ |  | PDA‚ÇÉ |
|:--:|:--:|:--:|:--:|:--:|
| ![f02a](./img/f02ar.png) | `√ó` | ![f02b](./img/f02b.png) | `=` | ![f02c](./img/f02cr.png) |


- for `‚ù∏L‚ÇÅ*`, add
  - `S ‚Üí S‚ÇÅS | Œµ`

---
Prove by counterexamples üÖ± `L‚ÇÅ ‚à© L‚ÇÇ`:
- `may` be context-free
  - ‚ù∂ All `regular languages` are context-free and the intersection of two regular lan¬≠guages is regular
    - ‚à¥ if L‚ÇÅ and L‚ÇÇ are regular and context-free, then `L‚ÇÅ ‚à© L‚ÇÇ` is both regular and context-free
  - ‚ù∑ If CFL‚ÇÅ ‚äÇ CFL‚ÇÇ, then CFL‚ÇÅ ‚à© CFL‚ÇÇ = CFL‚ÇÅ is still CFL
    - ex. L‚ÇÅ={a‚Åø|n=1,2,3,‚ãØ}, L‚ÇÇ=PALINDROME
    - L‚ÇÅ ‚äÇ L‚ÇÇ
  - ‚ù∏ L‚ÇÅ=PALINDROME, L‚ÇÇ=a‚Å∫b‚Å∫a‚Å∫, then L‚ÇÅ ‚à© L‚ÇÇ = {a‚Åøb·µêa‚Åø|n,m=1,2,3,‚ãØ; n,m are independent from each other}. This is a CFL which can be generated by the CFG below
    - S‚ÜíaSa|B
    - B‚ÜíbB|b
    - or by the PDA
      - ![f03](./img/f03.png)
- `may NOT` be context-free
  - ‚ù∂ Given CFL L‚ÇÅ = {a‚Åøb‚Åøa·µê| n,m=1,2,3,‚ãØ; n,m are independent from each other} = {aba, abaa, aabba, ‚ãØ} which can be generated by CFG G‚ÇÅ
    - S‚ÜíXA
    - X‚ÜíaXb|ab
    - A‚ÜíaA|a
    - L‚ÇÅ is also the product of CFL {a‚Åøb‚Åø} and RL a‚Å∫
  - CFL L‚ÇÇ={a‚Åøb·µêa·µê| n,m=1,2,3,‚ãØ; n,m are independent from each other} = {aba, aaba, abbaa, ‚ãØ}which can be generated by CFG G‚ÇÇ
    - S‚ÜíXA
    - X‚ÜíbXa|ba
    - A‚ÜíaA|a
    - L‚ÇÇ is also the product of RL a‚Å∫ and CFL {a‚Åøb‚Åø}
  - However, L‚ÇÉ = L‚ÇÅ ‚à© L‚ÇÇ = {a‚Åøb‚Åøa‚Åø| n=1,2,3,‚ãØ} is `non-context-free`
  - ‚ù∑ L‚ÇÅ = EQUAL = {all words with the same number of a's and b's} is CFL which can be generated by the CFG below
    - S‚ÜíbA | aB
    - A‚ÜíbAA | aS | a
    - B‚ÜíaBB | bS | b
  - L‚ÇÇ = {a‚Åøb·µêa‚Åø|n,m=1,2,3,‚ãØ; n,m are independent from each other} is CFL
  - but L‚ÇÉ=L‚ÇÅ ‚à© L‚ÇÇ = {a‚Åøb¬≤‚Åøa‚Åø| n=1,2,3,‚ãØ} = {abba, aabbbbaa, ‚ãØ} is `non-context-free` which can be proved by the `pumping lemma for CFL`



üçé Example 1
---
Given 
- L‚ÇÅ the PALINDROME with CFG1: S‚ÜíaSa | bSb | a | b | Œµ
- L‚ÇÇ = {a‚Åøb‚Åø} with CFG2: S‚ÜíaSb | Œµ

`‚ù∂ L‚ÇÅ+L‚ÇÇ` can be generated with
- `S‚ÜíS‚ÇÅ | S‚ÇÇ`
- S‚ÇÅ‚ÜíaS‚ÇÅa | bS‚ÇÅb | a | b | Œµ
- S‚ÇÇ‚ÜíaS‚ÇÇb | Œµ

`‚ù∑L‚ÇÅL‚ÇÇ` can be generated with
- `S‚ÜíS‚ÇÅS‚ÇÇ`
- S‚ÇÅ‚ÜíaS‚ÇÅa | bS‚ÇÅb | a | b | Œµ
- S‚ÇÇ‚ÜíaS‚ÇÇb | Œµ

`‚ù∏L‚ÇÅ*` can be generated with
- `S‚ÜíS‚ÇÅS | Œµ`
- S‚ÇÅ‚ÜíaS‚ÇÅa | bS‚ÇÅb | a | b | Œµ


üçé Example 2
---
Given 
- L‚ÇÅ the PALINDROME with CFG1: S‚ÜíaSa | bSb | a | b | Œµ over Œ£‚ÇÅ = {a,b}
- L‚ÇÇ = {c‚Åød‚Åø} with CFG2: S‚ÜícSd | Œµ over Œ£‚ÇÇ = {c,d}

Then `L‚ÇÅ+L‚ÇÇ` can be generated with
- S‚ÜíS‚ÇÅ | S‚ÇÇ
- S‚ÇÅ‚ÜíaS‚ÇÅa | bS‚ÇÅb | a | b | Œµ
- S‚ÇÇ‚ÜícS‚ÇÇd | Œµ
- over Œ£ = Œ£‚ÇÅ‚à™Œ£‚ÇÇ = {a,b,c,d}

üèÉ Practice: find `L‚ÇÅL‚ÇÇ, L‚ÇÅ*, and L‚ÇÇ*`

---

üèÉ Exercise 1
---
Given 
- L‚ÇÅ the EVENPALINDROME with CFG1: S‚ÜíaSa | bSb | Œµ
- L‚ÇÇ the ODDPALINDROME with CFG2: S‚ÜíaSa | bSb | a | b

Then `L‚ÇÅ+L‚ÇÇ` can be generated with
- S‚ÜíS‚ÇÅ | S‚ÇÇ
- S‚ÇÅ‚ÜíaS‚ÇÅa | bS‚ÇÅb | Œµ
- S‚ÇÇ‚ÜíaS‚ÇÇa | bS‚ÇÇb | a | b

üèÉ Practice: find `L‚ÇÅL‚ÇÇ, L‚ÇÅ*, and L‚ÇÇ*`


üçé Example 5
---
üÖê `L' may` be context-free
- ‚ù∂ If L is regular, then L' is also regular and both are context-free
- ‚ù∑ There are also some `nonregular but context-free` languages that have context-free complements such as PALINDROMEX on Œ£={a,b,X}:
  - PALINDROMEX = {sX rev(s) | s is any string in (a+b)*}
  - ={X, aXa, bXb, aaXaa,abXba, baXab, bbXbb, ‚ãØ}
  - can be accepted by a `dPDA`
    - ![f04](./img/f04.png)
  - to construct a PDA that accepts exactly those input strings that this machine rejects, we need to reverse the status of the halt states from ACCEPT to REJECT and vice versa
    - ![f05](./img/f05.png)
  - ‚ö†Ô∏è this trick can't be used on `nPDA` due to its `nondeterminism`

---
üÖë`L' may NOT` be context-free
- ‚ù∂ by an indirect argument: suppose the complement of every CFL were context-free.
  - Let L‚ÇÅ and L‚ÇÇ be any two such languages, then L‚ÇÅ' + L‚ÇÇ' are context-free,
  - so (L‚ÇÅ' + L‚ÇÇ')' is also context-free, i.e. (L‚ÇÅ' + L‚ÇÇ')' = L‚ÇÅ ‚à© L‚ÇÇ is also context-free, this is a `contradiction` to theorem 1 üÖ±.
- ‚ù∑ (optional) the complement of the `non-context-free language {a‚Åøb‚Åøa‚Åø}` is the context-free language L below:
  - ${ L = M_{pq} + M_{qr} + M_{pr} + M_{rp} + M_{qr} + M_{rq} + M }$ is context-free since
    - ${ M_{pq}=\{a^p b^q a^r | p,q,r=1,2,3,‚ãØ \text{ and } p>q\} }$ is CFL can be generated by CFG‚ÇÅ:
      - S‚ÜíAXA
      - X‚ÜíaXb|ab (‚ä®a‚Åøb‚Åø)
      - A‚ÜíaA|a (‚ä®aa*)
      - it generates (aa*)(a‚Åøb‚Åø)(aa*) = ${ a^p b^q a^r }$ = (a‚Å∫)(a‚Åøb‚Åø)(a‚Å∫)
      - meanwhile, the product of two context-free languages is context-free, so is the product of three context-free languages
    - ${ M_{qp}=\{a^p b^q a^r | p,q,r=1,2,3,‚ãØ \text{ and } q>p\} }$ is CFL can be generated by CFG‚ÇÇ:
      - S‚ÜíXBA
      - X‚ÜíaXb|ab (‚ä®a‚Åøb‚Åø)
      - B‚ÜíbB|b (‚ä®bb*)
      - A‚ÜíaA|a (‚ä®aa*)
      - (a‚Åøb‚Åø)(b‚Å∫)(a‚Å∫) = ${ a^p b^q a^r }$
    - ${ M_{pr}=\{a^p b^q a^r | p,q,r=1,2,3,‚ãØ \text{ and } p>r\} }$ is CFL can be generated by CFG‚ÇÉ:
      - S‚ÜíAX
      - X‚ÜíaXa|aBa (‚ä®a‚Åøbb*a‚Åø)
      - B‚ÜíbB|b (‚ä®bb*)
      - A‚ÜíaA|a (‚ä®aa*)
      - (aa*)(a‚Åøbb*a‚Åø) = ${ a^p b^q a^r }$
    - ${ M_{rp}=\{a^p b^q a^r | p,q,r=1,2,3,‚ãØ \text{ and } r>p\} }$ is CFL can be generated by CFG‚ÇÑ:
      - S‚ÜíXA
      - X‚ÜíaXa|aBa (‚ä®a‚Åøbb*a‚Åø)
      - B‚ÜíbB|b (‚ä®bb*)
      - A‚ÜíaA|a (‚ä®aa*)
      - (a‚Åøbb*a‚Åø)(aa*) = ${ a^p b^q a^r }$
    - ${ M_{qr}=\{a^p b^q a^r | p,q,r=1,2,3,‚ãØ \text{ and } q>r\} }$ is CFL can be generated by CFG‚ÇÖ:
      - S‚ÜíABX
      - X‚ÜíbXa|ba (‚ä®b‚Åøa‚Åø)
      - B‚ÜíbB|b (‚ä®bb*)
      - A‚ÜíaA|a (‚ä®aa*)
      - (a‚Å∫)(b‚Å∫)(b‚Åøa‚Åø) = ${ a^p b^q a^r }$
    - ${ M_{rq}=\{a^p b^q a^r | p,q,r=1,2,3,‚ãØ \text{ and } r>q\} }$ is CFL can be generated by CFG‚ÇÜ:
      - S‚ÜíAXA
      - X‚ÜíbXa|ba (‚ä®b‚Åøa‚Åø)
      - A‚ÜíaA|a (‚ä®aa*)
      - (a‚Å∫)(b‚Åøa‚Åø)(a‚Å∫) = ${ a^p b^q a^r }$
    - M = {the complement of the language defined by a‚Å∫b‚Å∫a‚Å∫}
      - = {all words not of the form ${ a^p b^q a^r }$ }
      - M is regular since it is the complement of a regular language 
  - ‚à¥ `L={a‚Åøb‚Åøa‚Åø}' is a CFL`, i.e. `L'={a‚Åøb‚Åøa‚Åø} is non-context-free`
    - The reason that the complement of a CFL can be non-context-free is that not all CFLs can be accepted by dPDAs.
    - Idea of the proof: $`¬¨ ((p=q)  å (q=r)) ‚Üî (p‚â†q) ‚à® (q‚â†r)`$
      - $`M_{pq}+M_{qp}`$ is for $`p‚â†q`$, $`M_{qr}+M_{rq}`$ is for $`q‚â†r`$
      - $`p‚â†r`$ is redundant, so $`M_{pr}+M_{rp}`$ is unnecessary, included here for symmetry.


‚òØ Theorem 2
---
- ‚ù∂ The `union` of a `context-free` language and a `regular` language must be `context-free`
  - because a RL is also a CFL
- but `may be regular or non-regular`
  - ex 0. if L‚ÇÅ‚äÇL‚ÇÇ, then L‚ÇÅ ‚à™ L‚ÇÇ = L‚ÇÇ, so its regularity depends on L‚ÇÇ
  - ex 1. PALINDROME is `nonregular context-free` and ${ \mathbf{(a+b)^*} }$ is regular
    - their union is regular since PALINDROME ‚äÇ ${ \mathbf{(a+b)^*} }$
  - ex 2. PALINDROME is `nonregular context-free` and ${ \mathbf{a^*} }$ is regular
    - their union is `nonregular context-free` since ${ \mathbf{a^*} }$ ‚äÇ PALINDROME
  - ex 3. {a‚Åøb‚Åø} is `nonregular context-free` and $`{ \mathbf{b^*a^*} }`$ is regular
    - their union is `nonregular` (the argument is out of scope)
  - ex 4. PALINDROME is nonregular context-free and the complement of ${ \mathbf{a^*} }$ is regular
    - their union is `all strings` so is regular since ${ \mathbf{a^*} }$ ‚äÇ PALINDROME
- ‚ù∑ The `intersection` of a `context-free` language L‚ÇÅ and a `regular` language L‚ÇÇ is always `context-free`
- (optional) prove by constructing a new PDA from the PDA accepts L‚ÇÅ and the FA accepts L‚ÇÇ
  - with the same idea as building the intersection machine for two FAs in Kleene's theorem



üçé (optional) Example 6
---
‚ûÄ Show the intersection of 
- the language EQUAL of words with the same total number of a 's and b's
  - ![f06](./img/f06.png)
- and the FA that accepts all words ending in the letter a
  - ![f07](./img/f07.png)

The result PDA:

![f08](./img/f08.png)

---
‚ûÅ show the language DOUBLEWORD is non-context-free.

Prove by contradiction:
- if DOUBLEWORD were a CFL, then when we inter¬≠sect it with any regular language, we must get a context-free language.
- $`DOUBLEWORD ‚à© a^+b^+a^+b^+ = a^nb^ma^nb^m`$, however, $`a^nb^ma^nb^m`$ is non-context-free.