__Grammatical format__

_ict chapter 13_


Capability of CFGs
---
CFGs can generate
- all regular languages, and
- some nonregular languages but not all possible languages


â˜¯ Theorem: All regular languages are context-free languages
---
Given any FA, there is a CFG that generates exactly the language accepted by the FA.
- `(sáµ¢, Ïƒ, sâ±¼)` denotes the edge from state `sáµ¢` to `sâ±¼` with letter `Ïƒ` on it

Prove by constructing a CFG for any given FA:
- â‘  Create a nonterminal for each state of the FA
  - the start state is the `S (start here)` nonterminal
- â‘¡ Create a production `Sáµ¢â†’ÏƒSâ±¼` for every edge `(sáµ¢, Ïƒ, sâ±¼)`, e.x.
  - X â†’ aY for (x,a,y)
  - X â†’ bX for (x,b,x)
- â‘¢ F â†’ Ïµ for every final state f

Then show that
- â¶ every word w=Ïƒâ‚Ïƒâ‚‚â‹¯Ïƒâ‚™â‹¯Ïƒâ‚‘ accepted by the FA can be generated from the CFG
  - (p1) there is a `semiword` for every `semipath`
    - `semiword` = (terminal)*(nonterminal)
    - `semipath` = (Ïƒ)*(s)


ğŸ Example 1
---
```mermaid
flowchart LR
  s(("S-"))
  m(("M"))
  f(("F+"))

  s-->|a|m
  s-->|b|s
  m-->|a|f
  m-->|b|s
  f-->|"a,b"|f
```
- The CFG created by the theorem:
  - S â†’ aM | bS
  - M â†’ aF | bS
  - F â†’ aF | bF | Ïµ
- When `baab` is running on the FA, 
  - a sequence of (semipath:semiword) is generated
    - S:S
    - S(b)S:bS
    - S(b)S(a)M:baM
    - S(b)S(a)M(a)F:baaF
    - S(b)S(a)M(a)F(b)F:baabF
- (p2) shows the sequence of semipaths accepts word `babbaaba` by this FA

- â· every word generated by th e CFG is accepted by the FA
  - any word `w` generated by the CFG is a semiword mapping to a semipath on the FA, and only when the nonterminal of the semiword is F, a word can be generated by applying `Fâ†’Ïµ`. i.e. Its corresponding semipath stops at a final state of the FA, i.e. `w` is accepted by the FA. 


ğŸ Example 2
---
- An FA defines the language of all words with an even number of a's
```mermaid
flowchart LR
  s(("S-"))
  m(("M"))
  f(("F+"))

  s-->|a|m
  s-->|b|s
  m-->|a|f
  m-->|b|m
  f-->|"b"|f
  f-->|a|m
```
- has the CFG below generated by the theorem
  - S â†’ bS|aM
  - M â†’ bM|aF
  - F â†’ bF|aM|Ïµ


â˜¯ Theorem: CFGs that generate RLs
---
If all the productions in a given CFG has only the two forms:
- â¶ nonterminal â†’ semiword=(terminal)*nonterminal
  - e.x. Náµ¤ â†’ wáµ¢Náµ¥
- â· nonterminal â†’ word
  - e.x. Nâ‚– â†’ wâ±¼

then the language generated by this CFG is `regular`.
- such a CFG is called a `regular grammar (RG)`
  - all RGs generate RLs
  - all RLs can be generated by RGs
  - âš ï¸ some non-RG CFGs can also generate RLs as well

Prove by constructing a TG accepts the language generated by this CFG:
- create a state for each nonterminal
  - the start state is for the S nonterminal
  - a final state for each word in form â·
- create an edge for each production
  - Náµ¤ â†’ wáµ¢Náµ¥: an edge from Náµ¤ to Náµ¥ labeled with wáµ¢
  - Nâ‚– â†’ wâ±¼: an edge from Nâ‚– to Fâ±¼ labeled with wâ±¼
- Any path in this TG from - to + 
  - corresponds to a word in the language of the TG (by concatenating labels)
  - also correÂ­sponds to a sequence of productions in the CFG generating the same word
- Conversely, every production of a word in this CFG
  - Sâ‡’wâ‚Nâ‚â‡’wâ‚wâ‚‚Nâ‚‚â‡’â‹¯ â‡’ wâ‚wâ‚‚â‹¯wâ‚™ corresponds to a path in this TG from - to +
- âˆ´ this TG â‰¡ this CFG


ğŸ Example 3
---
â‘  Given a RG1 
- S â†’ aaS|bbS|Ïµ, 
- a TG1 can be constructed following the previous theorem:
```mermaid
flowchart LR
s(("-"))
f(("+"))
s-->|"aa,bb"|s
s-->|Ïµ|f
```
- which corresponds to RE1: $\mathbf{(aa+bb)^*}$

- ---

â‘¡ Given a RG2 
- S â†’ aA|bB
- A â†’ aS | a
- B â†’ bS | b
- a TG2 can be constructed following the previous theorem:
```mermaid
flowchart LR
s(("-"))
A(("A"))
B(("B"))
f(("+"))
s-->|a|A
s-->|b|B
A-->|a|s
B-->|b|s
A-->|a|f
B-->|b|f
```
- which corresponds to RE2: $\mathbf{(aa+bb)^+}$

- ---

â‘¢ Given a RG3 
- S â†’ aaS|bbS|abX|baX|Ïµ
- X â†’ aaX|bbX|abS|baS
- a TG3 can be constructed following the previous theorem:
```mermaid
flowchart LR
s(("-"))
x(("X"))
f(("+"))

s-->|Ïµ|f
s-->|"aa,bb"|s
s-->|"ab,ba"|x
x-->|"aa,bb"|x
x-->|"ab,ba"|s
```
- which is EVEN-EVEN RE3: $\mathbf{(aa+bb + (ab+ba)(aa+bb)^*(ab+ba))^*}$


Eliminating Ïµ-productions
---
- An `Ïµ-production` has the form
  - N â†’ Ïµ
  - N is a nonterminal
- a nonterminal N is `nullable` if
  - there is a production N â†’ Ïµ, or
  - there is a derivation starts at N and leads to Ïµ:
    - N â‡’ â‹¯ â‡’ Ïµ


â˜¯ Theorem: Ïµ-production is removable
---
- If a CFL is generated by a CFG1 with Ïµ-productions,
- then there is a different CFG2 without Ïµ-productions generate 
  - the same CFL if it does not contain the empty word Ïµ
  - or the language of words in the CFL except Ïµ
- Let's say CFG2 is no-Ïµ-equivalent to CFG1

Prove by construction
- given a CFG1 with N â†’ Ïµ, a no-Ïµ-equivalent CFG2 can be constructed by 
- deleting all Ïµ-productions
- for each production P in CFG1 that contains `nullable nonterminals`, 
  - remove all `possible subsets` of these nullable nonterminals from P one subset a time
  - add a P' = P without `nullable nonterminals` for each removal


ğŸ Example 4
---
- the following CFG generates a single a
  - S â†’ aX
  - `X â†’ Ïµ`
- which can be generated by
  - S â†’ a
  - in which there is no Ïµ-production
- ---

ğŸ Example 5
---
- the no-Ïµ-equivalent CFG1 to EVENPALINDROME: S â†’ aSa|bSb|Ïµ:
  - S â†’ aSa | bSb | `aa | bb`
  - CFG1 generates all the words in EVENPALINDROME except Ïµ


ğŸ Example 6
---
- In the following CFG
  - S â†’ a | Xb | aYa
  - X â†’ Y | Ïµ
  - Y â†’ b | X
- both X and Y are nullable, so the no-Ïµ-equivalent CFG can be constructed as
  - S â†’ a | Xb | aYa | `b | aa`
  - X â†’ Y
  - Y â†’ b | X


ğŸ Example 7
---
- find the nullable nonterminals of complex CFGs by propagating marks such as
  - S â†’ Xay | YY | aX |ZYZ â·
  - X â†’ Za | bZ | ZZ | Yb â¸ 
  - Y â†’ Ya | XY | Ïµ â¶
  - Z â†’ aX | YYY  â· 
- the marking sequence â¶ â· â¸ shows that all the nonterminals are nullable, 
- so the no-Ïµ-equivalent CFG can be constructed
  - S â†’ XaY | YY | aX |ZYZ | aY | `a | Y | Z | Xa | YZ | ZY | ZZ`
  - X â†’ Za | bZ | ZZ | Yb | `a | b | Z`
  - Y â†’ Ya | XY | `a | X | Y`
  - Z â†’ aX | YYY | `a | Y | YY`


ğŸ Example 8
---
- S â†’ Xa
- X â†’ aX | bX | Ïµ

is no-Ïµ-equivalent to
- S â†’ Xa | `a`
- X â†’ aX | bX | `a | b`


ğŸ Example 9
---
An inefficient CFG generating the language defined by $\mathbf{(a+b)^*bb(a+b)^*}$, i.e. all words contains the substring `bb`:
- S â†’ XY
- X â†’ Zb
- Y â†’ bW
- Z â†’ AB
- W â†’ Z
- A â†’ aA | bA | Ïµ
- B â†’ Ba | Bb | Ïµ

is no-Ïµ-equivalent to
- S â†’ XY
- X â†’ Zb | `b`
- Y â†’ bW | `b`
- Z â†’ AB | `A | B`
- W â†’ Z â¶ (unit production)
- A â†’ aA | bA | `a | b`
- B â†’ Ba | Bb | `a | b`


â˜¯ Theorem: unit production is removable
---
- `one nonterminal â†’ another nonterminal` is called a `unit production`
- `a chain of unit productions` has the form of
  - A â‡’Xâ‚â‡’Xâ‚‚â‡’â‹¯â‡’B
- If a CFL is generated by a CFG1 without Ïµ-productions,
- then there is a no-Ïµ-equivalent CFG2 without Ïµ-productions and unit productions


Prove by construction
- if `Aâ†’B` and  the nonunit productions from B are
  - Bâ†’sâ‚|sâ‚‚|â‹¯
  - sáµ¢ is a string with nonterminals and terminals
- then the production `Aâ†’B` can be replaced by
  - Aâ†’sâ‚|sâ‚‚|â‹¯


ğŸ Example 10
---
Remove unit productions from the CFG below
- Sâ†’A | bb
- Aâ†’B | b
- Bâ†’S | a

â¶ separate the units from the nonunits:

|unit production | nonunit production|
|:--:|:--:|
|Sâ†’A |Sâ†’bb|
|Aâ†’B |Aâ†’b|
|Bâ†’S| Bâ†’a |

â· list all unit productions and `chains` of unit productions `without loops`
- create new proÂ­ductions by removing unit productions
- Sâ†’A gets Sâ†’b
- Sâ†’Aâ†’B gets Sâ†’a
- Aâ†’B gets Aâ†’a
- Aâ†’Bâ†’S gets Aâ†’bb
- Bâ†’S get  Bâ†’bb
- Bâ†’Sâ†’A gets Bâ†’b
  
âˆ´ the new CFG is
- Sâ†’ bb | `a | b`
- Aâ†’ b | `a | bb`
- Bâ†’ a | `b | bb`


â˜¯ Theorem: nonterminals and terminals are separable
---
- separates the terminals from the nonterminals in CFG productions
- For a given CFG1, there is another no-Ïµ-equivalent CFG2 whose productions are in one of two basic forms:
  - Nonterminal â†’ string of only nonterminals
  - Nontermial â†’ one terminal

Prove by construction:
- foreach letter Ïƒáµ¢ in Î£, if its used any terminal wáµ¢ in the productions, 
  - add a new production: Náµ¢â†’Ïƒáµ¢
- then replace each wáµ¢ in old productions with serials of Náµ¢'s


ğŸ Example 11
---
The CFG below
- S â†’ Xâ‚ | Xâ‚‚aXâ‚‚ | aSb | b
- Xâ‚ â†’ Xâ‚‚Xâ‚‚ | b
- Xâ‚‚ â†’ aXâ‚‚ | aaXâ‚

add two new productions
- Aâ†’a
- Bâ†’b

get the CNF of the CFG
- S â†’ Xâ‚ | Xâ‚‚AXâ‚‚ | ASB | B
- Xâ‚ â†’ Xâ‚‚Xâ‚‚ | B
- Xâ‚‚ â†’ AXâ‚‚ | AAXâ‚
- Aâ†’a
- Bâ†’b

âš ï¸ Above introduced 2 unit productions

ğŸ Example 12
---
- Sâ†’Na
- Nâ†’a|b

become
- Sâ†’NA
- Nâ†’a|b
- Aâ†’a

âš ï¸ Nâ†’a can NOT be used to turn Sâ†’Na into Sâ†’NN since it generates bb where the old CFG does not. So, a new rule Aâ†’a is needed.

Chomsky Normal Form (CNF)
---
A CFG in `Chomsky Normal Form (CNF)` has productions of only two forms
- â¶ nonterminal â†’ string of exactly two nonterminals
- â· nonterminal â†’ one terminal


â˜¯ Theorem: universality of CNF
---
The non-Ïµ words of any CFL can be generated by a CFG in CNF.


prove by construction:
- find the non-Ïµ-equivalent CFG1 without Ïµ-productions and unit productions for the CFG, whose productions are in only two forms
  - â¶ Nonterminal â†’ string of only nonterminals 
  - â· Nontermial â†’ one terminal
- leave â· intact
- separate â¶ based on the length of the right string



ğŸ Example 13
---
Convert the CFG below
- Sâ†’aSa|bSb|a|b|aa|bb
- the CFL is PALINDROME except for Ïµ

into CNF:
- separate terminals and nonterminals `without introducing unit productions`
  - Sâ†’ASA|BSB|a|b|AA|BB
  - Aâ†’a
  - Bâ†’b
- Sâ†’ASA can be separated by
  - Sâ†’ARâ‚
  - Râ‚â†’SA
- Sâ†’BSB can be separated by
  - Sâ†’BRâ‚‚
  - Râ‚‚â†’SB
- add Sâ†’Ïµ to the productions, we get PALINDROME which includes Ïµ


ğŸ Example 14
---
Convert the CFG below
- Sâ†’bA | aB
- Aâ†’bAA | aS | a
- Bâ†’aBB | bS | b
- the generated CFL is EQUAL

into CNF.

- separate terminals and nonterminals `without introducing unit productions`
  - Sâ†’YA | XB
  - Aâ†’YAA | XS | a
  - Bâ†’XBB | YS | b
  - `Xâ†’a`
  - `Yâ†’b`
- Aâ†’YAA can be separated by
  - Aâ†’YRâ‚
  - Râ‚â†’AA
- Bâ†’XBB can be separated by
  - Bâ†’XRâ‚‚
  - Râ‚‚â†’BB


ğŸ Example 15
---
Convert the CFG below
- Sâ†’aaaaS | aaaa
- the generated CFL is {aâ´â¿, n=1,2,...} = {aâ´, aâ¸, aÂ¹Â², ...}

into CNF.

- separate terminals and nonterminals `without introducing unit productions`
  - Sâ†’AAAAS | AAAA
  - `Aâ†’a`
- Sâ†’AAAA can be separated by
  - Sâ†’DD
  - Dâ†’AA 
  - or follow the algorithm
  - Sâ†’AXâ‚; Xâ‚â†’AXâ‚‚; Xâ‚‚â†’AA
- Sâ†’AAAAS i.e. Sâ†’DDS can be separated by
  - Sâ†’DRâ‚
  - Râ‚â†’DS
  - or follow the algorithm
  - Sâ†’AYâ‚; Yâ‚â†’AYâ‚‚; Yâ‚‚â†’AYâ‚ƒ; Yâ‚ƒâ†’AS


Leftmost derivations
---
- standardize the form of the derivations by
  - applying a rule of production  to the `leftmost nonterminal` in the working string
  - i.e. in the order from left to right
- e.x. the `leftmost nonterminal` in `abNbaXbYaZbN` is `N`


ğŸ Example 15
---
A leftmost derivation on the CFG below
- Sâ†’aSX | b
- Xâ†’Xb | a

is
- Sâ‡’aSX
- â‡’ aaSXX
- â‡’ aabXX
- â‡’ aabXbX
- â‡’ aababX
- â‡’ aababa


ğŸ Example 15
---
(p3) The word `aaabb` can be generated in several different production sequences by the CFG below
- Sâ†’XY
- Xâ†’XX | a
- Yâ†’YY | b

Derivation 1:
- Sâ‡’XY
- Sâ‡’(XX)(YY)
- Sâ‡’((a)(XX)(bb))
- Sâ‡’((a)(aa)(bb))

Derivation 2:
- Sâ‡’XY
- Sâ‡’(XX)(YY)
- Sâ‡’((XX)(a)(bb))
- Sâ‡’((aa)(a)(bb))

(p4) both derivations have a leftmost derivation respectively
- the leftmost derivation 1
  - Sâ‡’XY
  - Sâ‡’XXY
  - `Sâ‡’aXY`
  - Sâ‡’aXXY
  - Sâ‡’aaXY
  - Sâ‡’aaaY
  - Sâ‡’aaaYY
  - Sâ‡’aaabY
  - Sâ‡’aaabb
- the leftmost derivation 2
  - Sâ‡’XY
  - Sâ‡’XXY
  - `Sâ‡’XXXY`
  - Sâ‡’aXXY
  - Sâ‡’aaXY
  - Sâ‡’aaaY
  - Sâ‡’aaaYY
  - Sâ‡’aaabY
  - Sâ‡’aaabb


â˜¯ Theorem: all CFL words can be generated by leftmost derivation 
---
Any word that can be generated by a given CFG by some derivation also has a leftmost deÂ­rivation.


ğŸ Example 15
---
Given the CFG
- Sâ†’SâŠƒS | Â¬S | (S) | p | q

(p5) generate `(pâŠƒ(Â¬pâŠƒq))` in leftmost derivation:
- Sâ‡’(S)
- Sâ‡’(SâŠƒS)
- Sâ‡’(pâŠƒS)
- Sâ‡’(pâŠƒ(S))
- Sâ‡’(pâŠƒ(SâŠƒS))
- Sâ‡’(pâŠƒ(Â¬SâŠƒS))
- Sâ‡’(pâŠƒ(Â¬pâŠƒS))
- Sâ‡’(pâŠƒ(Â¬pâŠƒq))